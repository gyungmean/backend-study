# 06/메시지와 인터페이스
훌륭한 객체지향 코드를 얻기 위해서는 클래스가 아니라 객체를 지향해야 한다.  
-> 즉, 협력 안에서 객체가 수행하는 책임에 초점을 맞춰야 한다. 

  - 책임이 객체가 수신할 수 있는 메시지의 기반이 된다.
  - 애플리케이션은 클래스로 구성되지만 메시지를 통해서 정의된다.

## 1)협력과 메서드
#### 클라이언트-서버 모델
 - 메시지 : 객체들이 협력하기 위해 사용할 수 있는 유일한 의사소통 
 - 메시지 전송(메시지 패싱) : 한 객체가 다른 객체에게 도움을 요청하는 것
 - 메시지 전송자, 클라이언트 : 메시지를 전송하는 객체
 - 메시지 수신자, 서버 : 메시지를 수신하는 객체
 - 메서드 : 메시지를 수신했을 때 실제로 실행되는 함수 또는 프로시저
 - 퍼블릭 인터페이스 : 객체가 의사소통을 위해 외부에 공개하는 메시지의 집합
 - 오퍼레이션 : 퍼블릭 인터페이스에 포함된 메시지
 - 시그니처 : 오퍼레이션(또는 메서드)의 이름과 파라미터 목록을 합쳐 부르는 것


## 2)인터페이스와 설계 품질
좋은 인터페이스
- 최소한의 인터페이스 : 꼭 필요한 오퍼레이션만을 인터페이스에 포함
- 추상적인 인터페이스 : 어떻게 수행하는지가 아니라 무엇을 하는지를 표현
- 좋은 인터페이스를 설계할 수 있는 가장 좋은 방법은 책임 주도 설계 방법을 따르는 것.

퍼블릭 인터페이스의 품질
- 디미터 법칙
  - 협력이라는 컨텍스트 안에서 객체보다 메시지를 먼저 결정하면 두 객체 사이의 구조적인 결합도를 낮출 수 있다. 수신할 객체를 알지 못한 상태에서 메시지를 먼저 선택하기 때문에 객체의 내부 구조에 대해 고민할 필요가 없어진다.
  - 따라서 메시지가 객체를 선택하게 함으로써 의도적으로 디미터 법칙을 위반할 위험을 최소화할 수 있다.
- 묻지 말고 시켜라
  - 메세지를 먼저 선택하면 묻지 말고 시켜라 스타일에 따라 협력을 구조화하게 된다. 클라이언트의 관점에서 메시지를 선택하기 때문에 필요한 정보를 물을 필요 없이 원하는 것을 표현한 메시지를 전송하면 된다.
- 의도를 드러내는 인터페이스
  - 메세지를 먼저 선택하다는 것은 메시지를 전송하는 클라이언트의 관점에서 메시지의 이름을 정한다는 것이다. 당연히 그 이름에는 클라이언트가 무엇을 원하는지, 그 의도가 분명하게 드러날 수밖에 없다.
- 명령-쿼리 분리
  - 메시지를 먼저 선택한다는 것은 협력이라는 문맥 안에서 객체의 인터페이스에 관해 고민한다는 것을 의미한다. 객체가 단순히 어떤 일을 해야 하는지뿐만 아니라 협력 속에서 객체의 상태를 예측하고 이해하기 쉽게 만들기 위한 방법에 관해 고민하게 된다.
  - 따라서 예측 가능한 협력을 만들기 위해 명령과 쿼리를 분리하게 될 것이다.

## 3) 원칙의 함정
묻지 말고 시켜라와 디미터 법칙을 준수하는 것이 항상 긍정적인 결과로만 귀결되는 것은 아니다. 모든 상황에서 맹목적으로 위임 메서드를 추가하면 같은 퍼블릭 인터페이스 안에 어울리지 않는 오퍼레이션들이 공존하게 된다.  
-> 응집도가 낮아진다.

## 4) 명령-쿼리 분리 원칙
- 루틴: 어떤 절차를 묶어 호출 가능하도록 이름을 부여한 기능 모듈. 프로시저와 함수로 구분할 수 있다.
  - 프로시저: 정해진 절차에 따라 내부의 상태를 변경하는 루틴의 한 종류다. 부수효과를 발생시킬 수 있지만 값을 반환할 수 없다.
  - 함수: 어떤 절차에 따라 필요한 값을 계산해서 반환하는 루틴의 한 종류다. 값을 반환할 수 있지만 부수효과를 발생시킬 수 없다.
  

- 명령: 객체의 인터페이스 측면에서 프로시저를 부르는 또 다른 이름이다. 객체의 상태를 수정하는 오퍼레이션/객체의 상태를 변경하는 명령은 반환값을 가질 수 없다.
- 쿼리: 객체의 인터페이스 측면에서 함수를 부르는 또 다른 이름이다. 객체와 관련된 정보를 반환하는 오퍼레이션/객체 정보를 반환하는 쿼리는 상태를 변경할 수 없다

명령-쿼리 분리 원칙
- 오퍼레이션은 부수효과를 발생시키는 명령이거나 부수효과를 발생시키지 않는 쿼리 중 하나여야 한다.
- "질문이 답변을 수정해서는 안된다."
- 쿼리는 객체의 상태를 변경하지 않기 때문에 몇 번이고 반복적으로 호출하더라도 상관이 없다.
  - 명령이 개입하지 않는 한 쿼리의 값은 변경되지 않는다. 또한 쿼리들의 순서를 자유롭게 변경할 수도 있다.
- 부수효과를 가지는 명령으로부터 부수효과를 가지지 않는 쿼리를 명백하게 분리함으로써 제한적이나마 참조 투명성의 혜택을 누릴 수 있게 된다.

명령-쿼리 분리와 참조 투명성  
- 참조 투명성이란 "어떤 표현식 e가 있을 때 e의 값으로 e가 나타나는 모든 위치를 교체하더라도 결과가 달라지지 않는 특성"을 의미한다.
 

