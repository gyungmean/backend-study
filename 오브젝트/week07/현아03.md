# 03 역할, 책임, 협력
객체지향의 본질은 협력하는 객체들의 공동체를 창조하는 것임. 객체지향 설계의 핵심은 협력을 구성하기 위해 적절한 객체를 찾고 적절한 책임을 할당하는 과정에서 드러남.

## 01 협력
### 영화 예매 시스템 돌아보기
- 협력 - 객체들이 애플리케이션의 기능을 구현하기 위해 수행하는 상호작용
- 책임 - 객체가 협력에 참여하기 위해 수행하는 로직
- 역할 - 객체들이 협력 안에서 수행하는 객체들이 모여 객체가 수행

### 협력
- 한 객체는 어떤 것이 필요할 때 다른 객체에게 전적으로 위임 하거나 서로 협력
  - 객체는 메시지를 통해서 협력
  - 메시지를 수신한 객체는 메서드를 실행해 요청에 응답
    - 객체는 수신받은 메시지를 처리할 방법을 스스로 선택
    - 객체는 자율적인 존재
    - 객체 내부 구현 (상태, 행동)을 캡슐화 하여 자율성을 확보
- 객체 설계시 상태와 행동을 결정하는 기준
  - 객체가 참여하고 있는 협력에 따라 객체의 상태 와 행동이 정해짐
  - 메세지 처리 가능 여부로 협력이 결정 -> 협력이 객체의 행동을 결정 -> 행동이 객체의 상태를 결정
  - 객체의 상태는 그 객체의 행동에 필요한 정보가 무엇인지로 결정
  - 
### 협력이 설계를 위한 문맥을 결정한다
```
public class Movie {
    private Money fee;
    private DiscountPolicy discountPolicy;

    public Money calculateMovieFee(Screening screening) {
        return fee.minus(discountPolicy.calculateDiscountAmount(screening));
    }
}
```
- 객체의 행동을 결정하는 것은 객체가 참여하고 있는 협력이다
    - Movie라는 객체가 play라는 행동이 아닌 calculateMovieFee라는 행동만 있는 이유도 영화를 예매하기 위한 협력에 참여하고 있고, 요금을 계산하는 책임을 지고 있기 때문이다.
- 객체가 참여하는 협력이 객체를 구성하는 행동과 상태 모두를 결정한다.
    - 상태: 객체가 행동하는 데 필요한 정보에 의해 결정
    - 행동: 협력 안에서 객체가 처리할 메시지로 결정
- 따라서 협력은 객체를 설계하는 데 필요한 일종의 문맥(context)** 을 제공한다.

## 02 책임
### 책임이란 무엇인가
**책임**
- 협력에 참여하기 위해 객체가 수행하는 행동
- 객체에 의해 정의되는 응집도 있는 행위의 집합
- 객체가 유지해야 하는 정보와 수행할 수 있는 행동에 대해 개략적으로 서술한 문장 
- 하는 것
  - 객체 생성 및 계산 수행 등 스스로 하는것
  - 다른 객체의 행동을 시작하는 것
  - 다른 객체의 활동을 제어, 조절하는 것
- 아는 것
  - 사적인 정보를 아는것
  - 관련된 객체를 아는것
  - 자신이 유도하거나 계산할 수 있는 것에 관해 아는 것

**영화 예매 시스템에서의 책임**

Screening: 영화를 예매하는 것
- 자신이 상영할 영화를 알고 있어야 한다.
- 영화를 예매 할 수 있어야 한다

Movie: 요금을 계산하는 것
- 가격과 적용된 할인 정책에 대해 알고 있어야 한다
- 예매 가격을 계산한다.

적절한 협력이 적절한 책임을 제공하고
</br>적절한 책임을 적절한 객체에게 전달해야 한다.

### 책임 할당
책임을 수행할 정보 전문가를 찾는다.

### 책임 주도 설계
- 시스템이 사용자에게 제공해야 하는 기능인 시스템 책임을 파악한다.
- 시스템 책임을 더 작은 책임으로 분활한다.
- 분활된 책임을 수행할 수 있는 적절한 객체 또는 역할을 찾아 책임을 할당한다.
- 객체가 책임을 수행하는 도중 다른 객체의 도움이 필요한 경우 이를 책임질 적절한 객체 또는 역할을 찾는다.
- 해당 객체 또는 역할에게 책임을 할당함으로써 두 객체가 협력하게 된다.

**책임을 할당할 때 고려해야 하는 두 가지 요소**
- 메시지가 객체를 결정
  - 객체가 최소한의 인터페이스를 가질 수 있게 됨
  - 객체는 충분히 추상적인 인터페이스를 가질 수 있게 됨
- 행동이 상태를 결정한다
  - 객체의 본질은 상태가 아니라 행동(책임)
  - 행동이 상태를 결정한다, 상태가 행동을 결정하는 게 아니다
      - 상태부터 정하면 내부 구현이 드러나 캡슐화가 깨짐
      - 객체는 협력 속에서 어떤 행동을 해야 하는지로 설계해야 한다
  - 협력 → 행동(책임) → 상태 순으로 생각하라

## 03 역할
객체는 협력이라는 주어진 문맥 안에서 특정한 목적을 갖게 됨
- 객체의 목적은 협력 안에서 객체가 맡게 되는 책임을 집합으로 표시
- 객체가 어떤 특정한 협력 안에서 수행하는 책임의 집합을 역할이라고 함

역할을 통해 유연하고 재사용 가능한 협력을 얻을 수 있기 때문에 역할이 중요함. 유용하고 재사용 가능한 설계라는 문맥에서 역할은 너무나 중요함.

여러 종류의 객체들이 참여할 수 있다면 역할이라고 부르면 됨.
